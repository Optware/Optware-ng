--- configure.ac.orig	2006-11-12 13:15:39.000000000 -0800
+++ configure.ac	2006-12-01 23:30:32.000000000 -0800
@@ -270,25 +270,11 @@
 #
 
 AC_MSG_CHECKING([if we are compiling against glibc])
-AC_RUN_IFELSE(
-	[
-		AC_LANG_PROGRAM(
-			[
-				#include <stdlib.h>
-				#ifdef __GLIBC__
-				#define STATUS 0
-				#else
-				#define STATUS 1
-				#endif
-			],
-			[
-				return STATUS;
-			]
-		)
-	], 
-	[glibc=yes], 
-	[glibc=no] 
-)
+if test ${LIBC_STYLE} = glibc; then
+	glibc=yes
+else
+	glibc=no
+fi
 
 if test "$glibc" = yes; then
 	AC_MSG_RESULT(yes)
@@ -593,26 +579,7 @@
 #
 
 AC_MSG_CHECKING([if realpath accepts null for its second argument])
-AC_RUN_IFELSE(
-	[
-		AC_LANG_PROGRAM(
-			[
-				#include <limits.h>
-				#include <errno.h>
-				#include <stdlib.h>
-			],
-			[
-				int status; 
-				char *res; 
-				res = realpath( "somefile", 0 ); 
-				status = !(res != 0 || errno == ENOENT); 
-				exit( status );
-			]
-		)
-	], 
-	[have_realpath_null=yes], 
-	[have_realpath_null=no] 
-)
+	have_realpath_null=no
 
 if test "$have_realpath_null" = yes; then
 	AC_MSG_RESULT(yes)
@@ -667,29 +634,7 @@
 if test "$ac_cv_func_fwprintf" = yes; then
 
 	AC_MSG_CHECKING([if fwprintf is broken])
-	AC_RUN_IFELSE(
-		[
-			AC_LANG_PROGRAM(
-				[
-					#include <stdlib.h>
-					#include <stdio.h>
-					#include <locale.h>
-					#include <wchar.h>
-				],
-				[
-					setlocale( LC_ALL, "" );
-					fwprintf( stderr, L"%ls%ls", L"", L"fish:" );
-				]
-			)
-		],
-	    [
 			AC_MSG_RESULT(no)
-		],
-	    [
-			AC_MSG_RESULT([yes])
-			AC_DEFINE([HAVE_BROKEN_FWPRINTF], [1], [Define to 1 one if the implemented fwprintf is broken])
-		] 
-	)
 
 fi
 
