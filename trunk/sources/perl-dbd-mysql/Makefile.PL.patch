--- Makefile.PL.orig	2007-05-28 07:28:05.000000000 -0700
+++ Makefile.PL	2007-08-14 10:22:09.000000000 -0700
@@ -20,7 +20,7 @@
 use Data::Dumper ();
 use File::Path;
 use File::Copy;
-require DBI::DBD;
+#require DBI::DBD;
 
 my $TESTDB = "test";
 
@@ -736,7 +736,19 @@
 }
 
 sub macro {
-  "\n" . DBI::DBD::dbd_postamble(@_) . <<"POSTAMBLE";
+  "\n" . <<"POSTAMBLE";
+# --- This section was generated by DBI::DBD::dbd_postamble()
+DBI_INSTARCH_DIR=/opt/lib/perl5/site_perl/PERL_VERSION/PERL_ARCH/auto/DBI
+DBI_DRIVER_XST=/opt/lib/perl5/site_perl/PERL_VERSION/PERL_ARCH/auto/DBI/Driver.xst
+
+# The main dependancy (technically correct but probably not used)
+\$(BASEEXT).c: \$(BASEEXT).xsi
+
+# This dependancy is needed since MakeMaker uses the .xs.o rule
+\$(BASEEXT)\$(OBJ_EXT): \$(BASEEXT).xsi
+
+\$(BASEEXT).xsi: \$(DBI_DRIVER_XST)
+\t\$(PERL) -p -e "s/~DRIVER~/\$(BASEEXT)/g" \$(DBI_DRIVER_XST) > \$(BASEEXT).xsi
 
 installhtml: lib/DBD/mysql/INSTALL.pod
 \tpod2html --infile=lib/DBD/mysql/INSTALL.pod --outfile=INSTALL.html
